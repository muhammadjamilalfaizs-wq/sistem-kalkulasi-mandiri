<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkSync | Workforce Management System</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1A237E">
    <meta name="description" content="WorkSync: Your Workforce, Perfectly Synchronized">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== VARIABLES ===== */
        :root {
            /* WorkSync Brand Colors */
            --primary: #1A237E;      /* Navy Blue - Professional */
            --primary-dark: #0D1538;
            --primary-light: #283593;
            --secondary: #00B0FF;    /* Electric Blue - Tech/Innovation */
            --secondary-dark: #0091EA;
            --accent: #00C853;       /* Lime Green - Growth/Success */
            --accent-light: #00E676;
            --warning: #FF9100;
            --danger: #FF1744;
            --info: #2962FF;
            
            /* Neutrals */
            --gray-50: #FAFAFA;
            --gray-100: #F5F5F5;
            --gray-200: #EEEEEE;
            --gray-300: #E0E0E0;
            --gray-400: #BDBDBD;
            --gray-500: #9E9E9E;
            --gray-600: #757575;
            --gray-700: #616161;
            --gray-800: #424242;
            --gray-900: #212121;
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            --gradient-secondary: linear-gradient(135deg, var(--secondary) 0%, #18FFFF 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent) 0%, #69F0AE 100%);
            
            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg: 0 10px 28px rgba(0,0,0,0.12);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.15);
            
            /* Border Radius */
            --radius-sm: 6px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 28px;
            
            /* Transitions */
            --transition-fast: 0.2s ease;
            --transition-base: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===== RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: var(--gray-900);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ===== TYPOGRAPHY ===== */
        h1, h2, h3, h4, h5 {
            font-weight: 600;
            line-height: 1.2;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 1.75rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            position: relative;
            display: inline-block;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 40px;
            height: 4px;
            background: var(--gradient-secondary);
            border-radius: 2px;
        }

        h3 {
            font-size: 1.25rem;
            color: var(--gray-800);
        }

        p {
            color: var(--gray-600);
            line-height: 1.7;
        }

        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .text-muted { color: var(--gray-500); }

        /* ===== WORK SYNC LOGO ===== */
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .logo-icon::before {
            content: '⟳';
            color: white;
            font-size: 24px;
            font-weight: bold;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-main {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            letter-spacing: -0.5px;
        }

        .logo-tagline {
            font-size: 0.85rem;
            color: var(--secondary);
            font-weight: 500;
            letter-spacing: 1px;
            margin-top: 2px;
        }

        /* ===== LAYOUT ===== */
        .app-container {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 30px;
            margin-top: 20px;
        }

        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }

        /* ===== NAVBAR ===== */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--gray-200);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: var(--transition-base);
        }

        .user-profile:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .avatar {
            width: 36px;
            height: 36px;
            background: var(--gradient-secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        /* ===== STATS CARDS ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow-md);
            transition: var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-secondary);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .stat-trend {
            font-size: 0.875rem;
            padding: 4px 12px;
            border-radius: 20px;
            background: rgba(0, 176, 255, 0.1);
            color: var(--secondary);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        /* ===== MAIN CARDS ===== */
        .main-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 32px;
            box-shadow: var(--shadow-md);
            margin-bottom: 30px;
            transition: var(--transition-base);
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .main-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient-secondary);
        }

        .main-card:hover {
            box-shadow: var(--shadow-lg);
            border-color: var(--gray-200);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .card-actions {
            display: flex;
            gap: 12px;
        }

        /* ===== FORMS ===== */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-700);
            font-size: 0.875rem;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 15px;
            transition: var(--transition-base);
            background: white;
            color: var(--gray-900);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(0, 176, 255, 0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* ===== BUTTONS ===== */
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-base);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--gradient-secondary);
            color: white;
        }

        .btn-success {
            background: var(--accent);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--gray-300);
            color: var(--gray-700);
        }

        .btn-outline:hover {
            border-color: var(--secondary);
            color: var(--secondary);
            background: rgba(0, 176, 255, 0.05);
        }

        .btn-sm {
            padding: 10px 16px;
            font-size: 13px;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        /* ===== TABLES ===== */
        .table-wrapper {
            overflow-x: auto;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            background: white;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        .table th {
            background: var(--gray-50);
            color: var(--gray-700);
            font-weight: 600;
            text-align: left;
            padding: 16px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--gray-200);
        }

        .table td {
            padding: 16px;
            border-bottom: 1px solid var(--gray-200);
            color: var(--gray-700);
            vertical-align: top;
        }

        .table tr:hover {
            background: var(--gray-50);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        /* ===== DAY BADGE ===== */
        .day-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }

        .day-weekday {
            background: rgba(0, 176, 255, 0.1);
            color: var(--secondary);
        }

        .day-weekend {
            background: rgba(255, 64, 129, 0.1);
            color: #FF4081;
        }

        /* ===== NOTES COLUMN ===== */
        .notes-cell {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .notes-cell.expanded {
            white-space: normal;
            overflow: visible;
        }

        /* ===== BADGES ===== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background: rgba(0, 200, 83, 0.1);
            color: var(--accent);
        }

        .badge-warning {
            background: rgba(255, 145, 0, 0.1);
            color: var(--warning);
        }

        .badge-info {
            background: rgba(41, 98, 255, 0.1);
            color: var(--info);
        }

        /* ===== CALCULATION PANEL ===== */
        .calculation-panel {
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--radius-lg);
            padding: 32px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .calculation-panel::before {
            content: '⟳';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 120px;
            opacity: 0.1;
            color: white;
        }

        .calculation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .calc-item {
            text-align: center;
            padding: 24px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .calc-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .calc-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .total-row {
            background: white;
            color: var(--primary);
            padding: 32px;
            border-radius: var(--radius-md);
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .total-label {
            font-size: 0.875rem;
            opacity: 0.7;
            margin-bottom: 8px;
        }

        .total-value {
            font-size: 2.5rem;
            font-weight: 700;
        }

        /* ===== MODALS ===== */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 21, 56, 0.8);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 500px;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            padding: 24px;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 32px;
        }

        .modal-footer {
            padding: 24px;
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* ===== TOAST ===== */
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            padding: 16px 24px;
            border-radius: var(--radius-md);
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 9999;
            box-shadow: var(--shadow-lg);
            animation: slideInRight 0.3s ease;
        }

        /* ===== FOOTER ===== */
        .footer {
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid var(--gray-200);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .footer-links {
            display: flex;
            gap: 24px;
        }

        .footer-link {
            color: var(--gray-600);
            text-decoration: none;
            font-size: 0.875rem;
            transition: var(--transition-base);
        }

        .footer-link:hover {
            color: var(--secondary);
        }

        /* ===== CALCULATION DETAILS ===== */
        .calculation-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .detail-item.total {
            border-top: 2px solid var(--primary);
            margin-top: 8px;
            padding-top: 12px;
            font-weight: 600;
        }

        .detail-label {
            color: var(--gray-600);
            font-weight: 500;
        }

        .detail-value {
            color: var(--gray-800);
            font-weight: 600;
        }

        .separator {
            height: 1px;
            background: var(--gray-300);
            margin: 16px 0;
        }

        /* ===== UTILITIES ===== */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--gray-500);
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            background: var(--gray-100);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            color: var(--gray-400);
            font-size: 32px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent);
        }

        .mt-1 { margin-top: 4px; }
        .mt-4 { margin-top: 16px; }
        .ml-1 { margin-left: 4px; }
        .mr-1 { margin-right: 4px; }
        .mr-2 { margin-right: 8px; }

        /* ===== ANIMATIONS ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(40px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            body {
                padding: 16px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .navbar {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            
            .nav-right {
                width: 100%;
                justify-content: space-between;
            }
            
            .main-card {
                padding: 24px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-left">
            <div class="logo">
                <div class="logo-icon">
                    <!-- Sync icon animated -->
                </div>
                <div class="logo-text">
                    <div class="logo-main">WORK SYNC</div>
                    <div class="logo-tagline">Your Workforce, Perfectly Synchronized</div>
                </div>
            </div>
        </div>
        <div class="nav-right">
            <div class="time-display">
                <div id="current-date" class="text-sm text-muted">Selasa, 19 Des 2025</div>
                <div id="current-time" class="text-lg font-bold">05:31:45</div>
            </div>
            <div class="user-profile" id="user-profile">
                <div class="avatar" id="user-avatar">JD</div>
                <div>
                    <div class="text-sm font-medium" id="user-name">John Doe</div>
                    <div class="text-xs text-muted" id="user-position">HR Manager</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-trend">+12%</div>
            </div>
            <div class="stat-value" id="stat-total-hours">0 jam</div>
            <div class="stat-label">Total Jam Kerja</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="stat-trend">On Track</div>
            </div>
            <div class="stat-value" id="stat-total-days">0 hari</div>
            <div class="stat-label">Hari Kerja</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-header">
                <div class="stat-icon">
                    <i class="fas fa-money-bill-wave"></i>
                </div>
                <div class="stat-trend">Estimated</div>
            </div>
            <div class="stat-value" id="stat-estimated-salary">Rp 0</div>
            <div class="stat-label">Estimasi Gaji</div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="app-container">
        <!-- Left Column -->
        <div>
            <!-- Input Form -->
            <div class="main-card">
                <div class="card-header">
                    <div>
                        <h2>Input Kehadiran</h2>
                        <p class="text-sm text-muted">Tambahkan data kehadiran harian</p>
                    </div>
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span class="text-sm">Online</span>
                    </div>
                </div>
                
                <div class="edit-notice" id="edit-notice" style="display: none;">
                    <div class="badge badge-warning">
                        <i class="fas fa-edit mr-2"></i>Mode Edit Aktif
                    </div>
                </div>
                
                <form id="attendance-form">
                    <div class="form-group">
                        <label class="form-label" for="date">
                            <i class="far fa-calendar"></i>
                            Tanggal Kerja
                        </label>
                        <input type="date" id="date" class="form-control" required>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="start-time">
                                <i class="fas fa-sign-in-alt"></i>
                                Jam Masuk
                            </label>
                            <input type="time" id="start-time" class="form-control" value="08:00" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="end-time">
                                <i class="fas fa-sign-out-alt"></i>
                                Jam Pulang
                            </label>
                            <input type="time" id="end-time" class="form-control" value="17:00" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="break-time">
                            <i class="fas fa-coffee"></i>
                            Waktu Istirahat
                        </label>
                        <select id="break-time" class="form-control">
                            <option value="1">1 jam (Standar)</option>
                            <option value="0.5">30 menit</option>
                            <option value="1.5">1 jam 30 menit</option>
                            <option value="2">2 jam</option>
                            <option value="0">Tidak ada</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="day-type">
                            <i class="fas fa-calendar-day"></i>
                            Tipe Hari Kerja
                        </label>
                        <select id="day-type" class="form-control">
                            <option value="kerja">Hari Kerja (Senin-Jumat)</option>
                            <option value="libur5">Hari Libur (5 Hari Kerja)</option>
                            <option value="libur6">Hari Libur (6 Hari Kerja) - Sabtu</option>
                        </select>
                        <div class="text-xs text-muted mt-2">Pilih sesuai jenis hari untuk perhitungan lembur yang tepat</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="overtime">
                            <i class="fas fa-clock"></i>
                            Jam Lembur (Opsional)
                        </label>
                        <input type="number" id="overtime" class="form-control" min="0" step="0.5" placeholder="Contoh: 3.5">
                        <div class="text-xs text-muted mt-2">Masukkan dalam format jam (contoh: 3.5 untuk 3 jam 30 menit)</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="note">
                            <i class="fas fa-sticky-note"></i>
                            Catatan
                        </label>
                        <textarea id="note" class="form-control" rows="3" placeholder="Tambahkan catatan khusus..."></textarea>
                    </div>
                    
                    <div class="btn-group">
                        <button type="submit" id="submit-btn" class="btn btn-primary">
                            <i class="fas fa-save mr-2"></i>Simpan Data
                        </button>
                        <button type="button" id="update-btn" class="btn btn-secondary" style="display: none;">
                            <i class="fas fa-sync-alt mr-2"></i>Update
                        </button>
                        <button type="button" id="cancel-edit" class="btn btn-outline" style="display: none;">
                            <i class="fas fa-times mr-2"></i>Batal
                        </button>
                        <button type="button" id="reset-form" class="btn btn-outline">
                            <i class="fas fa-redo mr-2"></i>Reset
                        </button>
                    </div>
                    
                    <input type="hidden" id="edit-index" value="-1">
                </form>
            </div>
            
            <!-- Configuration -->
            <div class="main-card">
                <div class="card-header">
                    <h2>Konfigurasi Sistem</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="monthly-salary">
                        <i class="fas fa-money-bill"></i>
                        Gaji Bulanan
                    </label>
                    <div class="form-grid">
                        <input type="number" id="monthly-salary" class="form-control" value="5500000" min="1000000" step="500000">
                        <button type="button" id="save-salary" class="btn btn-success">
                            <i class="fas fa-check mr-2"></i>Simpan
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="end-normal-time">
                        <i class="fas fa-stopwatch"></i>
                        Batas Waktu Normal
                    </label>
                    <input type="time" id="end-normal-time" class="form-control" value="04:00">
                </div>
                
                <div class="separator" style="height: 1px; background: var(--gray-200); margin: 24px 0;"></div>
                
                <h3 class="mb-4">Manajemen Data</h3>
                <div class="btn-group" style="margin-top: 0;">
                    <button id="delete-all-data" class="btn btn-danger">
                        <i class="fas fa-trash-alt mr-2"></i>Hapus Semua
                    </button>
                    <button id="export-data" class="btn btn-outline">
                        <i class="fas fa-download mr-2"></i>Export Data
                    </button>
                    <button id="backup-data" class="btn btn-outline">
                        <i class="fas fa-file-export mr-2"></i>Backup
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Right Column -->
        <div>
            <!-- Attendance Table -->
            <div class="main-card">
                <div class="card-header">
                    <div>
                        <h2>Riwayat Kehadiran</h2>
                        <p class="text-sm text-muted" id="record-count">Total 0 records</p>
                    </div>
                    <div class="card-actions">
                        <button id="print-data" class="btn btn-outline btn-sm">
                            <i class="fas fa-print mr-2"></i>Print
                        </button>
                        <div class="badge badge-info">
                            <i class="fas fa-database mr-2"></i>Local Storage
                        </div>
                    </div>
                </div>
                
                <div class="table-wrapper">
                    <table class="table" id="attendance-table">
                        <thead>
                            <tr>
                                <th>Tanggal & Hari</th>
                                <th>Jam Kerja</th>
                                <th>Istirahat</th>
                                <th>Lembur</th>
                                <th>Total</th>
                                <th>Catatan</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="attendance-data">
                            <!-- Data akan diisi -->
                        </tbody>
                    </table>
                    
                    <div id="empty-state" class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-clipboard-list"></i>
                        </div>
                        <h3>Belum Ada Data</h3>
                        <p class="text-muted">Mulai dengan menambahkan data kehadiran Anda</p>
                        <button id="add-first-data" class="btn btn-primary mt-4">
                            <i class="fas fa-plus mr-2"></i>Tambah Data Pertama
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Salary Calculation -->
            <div class="calculation-panel">
                <h2 style="color: white; margin-bottom: 32px;">Ringkasan Gaji</h2>
                
                <div class="calculation-grid">
                    <div class="calc-item">
                        <div class="calc-value" id="calc-total-days">0</div>
                        <div class="calc-label">Hari Kerja</div>
                    </div>
                    <div class="calc-item">
                        <div class="calc-value" id="calc-total-hours">0</div>
                        <div class="calc-label">Total Jam</div>
                    </div>
                    <div class="calc-item">
                        <div class="calc-value" id="calc-overtime-hours">0</div>
                        <div class="calc-label">Jam Lembur</div>
                    </div>
                    <div class="calc-item">
                        <div class="calc-value" id="calc-hourly-rate">Rp 0</div>
                        <div class="calc-label">Upah/Jam</div>
                    </div>
                </div>
                
                <div class="total-row">
                    <div class="total-label">ESTIMASI TOTAL GAJI</div>
                    <div class="total-value" id="calc-total-salary">Rp 0</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div>
                <p class="text-sm">© 2025 <strong>WorkSync</strong> v3.0</p>
                <p class="text-xs text-muted">Your Workforce, Perfectly Synchronized</p>
            </div>
            <div class="footer-links">
                <a href="#" class="footer-link" id="contact-support">Support</a>
                <a href="#" class="footer-link" id="privacy-policy">Privacy</a>
                <a href="#" class="footer-link" id="terms">Terms</a>
            </div>
        </div>
    </footer>

    <!-- Delete Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="color: white; margin: 0;">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    Konfirmasi Hapus
                </h3>
                <button class="close-modal" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer;">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="width: 80px; height: 80px; background: rgba(255, 23, 68, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                        <i class="fas fa-trash-alt" style="font-size: 32px; color: var(--danger);"></i>
                    </div>
                    <h3>Hapus Semua Data?</h3>
                    <p class="text-muted">Anda akan menghapus <strong id="delete-count">0</strong> data kehadiran.</p>
                </div>
                <div class="form-group">
                    <label class="form-label">Ketik "HAPUS" untuk konfirmasi</label>
                    <input type="text" id="confirm-delete" class="form-control" placeholder="Ketik HAPUS disini...">
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancel-delete" class="btn btn-outline">Batal</button>
                <button id="confirm-delete-btn" class="btn btn-danger" disabled>
                    <i class="fas fa-trash-alt mr-2"></i>Hapus Semua
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ==================== GLOBAL VARIABLES ====================
        let attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || [
            { date: "11/12/2025", hours: "08.00–17.00", breakTime: 1, overtime: 0, totalHours: 8, note: "Ttd kontrak", dayType: "kerja" },
            { date: "12/12/2025", hours: "07.00–16.00", breakTime: 1, overtime: 0, totalHours: 8, note: "Induction", dayType: "kerja" },
            { date: "13/12/2025", hours: "07.00–16.00", breakTime: 1, overtime: 0, totalHours: 8, note: "Induction", dayType: "kerja" },
            { date: "15/12/2025", hours: "19.00–06.00", breakTime: 1, overtime: 3.5, totalHours: 11.5, note: "Kerja lembur", dayType: "kerja" },
            { date: "16/12/2025", hours: "18.00–08.00", breakTime: 1, overtime: 2.5, totalHours: 10, note: "", dayType: "libur5" }
        ];

        let monthlySalary = parseInt(localStorage.getItem('monthlySalary')) || 5500000;
        let endNormalTime = localStorage.getItem('endNormalTime') || '04:00';
        let isEditMode = false;
        let currentEditIndex = -1;

        // ==================== FUNGSI PERHITUNGAN JAM KERJA ====================
        function hitungJamKerjaReal(jamMasuk, jamPulang) {
            const [jm, mm] = jamMasuk.split(":").map(Number);
            const [jp, mp] = jamPulang.split(":").map(Number);
            
            const menitMasuk = jm * 60 + mm;
            const menitPulang = jp * 60 + mp;
            
            let selisihMenit = menitPulang - menitMasuk;
            
            if (selisihMenit < 0) {
                selisihMenit += 24 * 60;
            }
            
            return selisihMenit / 60;
        }

        function pisahkanJam(totalJam) {
            const jamNormal = Math.min(totalJam, 8);
            const jamLembur = Math.max(totalJam - 8, 0);
            return { jamNormal, jamLembur };
        }

        // ===== HARI KERJA =====
        function konversiLemburHariKerja(jamLembur) {
            if (jamLembur <= 0) return 0;
            if (jamLembur === 1) return 1.5;
            if (jamLembur === 2) return 3.5;
            if (jamLembur >= 3) {
                return 5.5 + (jamLembur - 3) * 2;
            }
            return 0;
        }

        // ===== HARI LIBUR 5 HARI =====
        function konversiLemburHariLibur5(jam) {
            if (jam <= 0) return 0;
            
            let nilai = 0;
            
            for (let i = 1; i <= jam; i++) {
                if (i <= 7) {
                    nilai += 2;
                } else if (i === 8) {
                    nilai += 3;
                } else {
                    nilai += 4;
                }
            }
            
            return nilai;
        }

        // ===== HARI LIBUR 6 HARI (SABTU) =====
        function konversiLemburHariLibur6(jam) {
            if (jam <= 0) return 0;
            
            let nilai = 0;
            
            for (let i = 1; i <= jam; i++) {
                if (i <= 5) {
                    nilai += 2;
                } else if (i <= 7) {
                    nilai += 3;
                } else {
                    nilai += 4;
                }
            }
            
            return nilai;
        }

        // ===== FUNGSI UTAMA PERHITUNGAN =====
        function hitungKerja({ jamMasuk, jamPulang, tipeHari, istirahat = 1 }) {
            // Hitung total jam kerja real (termasuk istirahat)
            let totalJamKerjaReal = hitungJamKerjaReal(jamMasuk, jamPulang);
            
            // Kurangi waktu istirahat
            totalJamKerjaReal = Math.max(totalJamKerjaReal - istirahat, 0);
            
            let jamNormal = 0;
            let jamLemburReal = 0;
            let nilaiLembur = 0;
            
            if (tipeHari === "kerja") {
                const pisah = pisahkanJam(totalJamKerjaReal);
                jamNormal = pisah.jamNormal;
                jamLemburReal = Math.floor(pisah.jamLembur);
                nilaiLembur = konversiLemburHariKerja(jamLemburReal);
            } 
            else if (tipeHari === "libur5") {
                jamNormal = 0;
                jamLemburReal = Math.floor(totalJamKerjaReal);
                nilaiLembur = konversiLemburHariLibur5(jamLemburReal);
            }
            else if (tipeHari === "libur6") {
                const pisah = pisahkanJam(totalJamKerjaReal);
                jamNormal = pisah.jamNormal; // Sabtu masih ada jam normal 5 jam
                jamLemburReal = Math.floor(pisah.jamLembur);
                nilaiLembur = konversiLemburHariLibur6(jamLemburReal);
            }
            
            const totalDibayarDalamJam = jamNormal + nilaiLembur;
            
            return {
                totalJamKerjaReal,
                jamNormal,
                jamLemburReal,
                nilaiLembur,
                totalDibayarDalamJam
            };
        }

        // ==================== UTILITY FUNCTIONS ====================
        function formatRupiah(amount) {
            return 'Rp ' + amount.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }
        
        function getDayName(dateString) {
            const [day, month, year] = dateString.split('/').map(Number);
            const date = new Date(year, month - 1, day);
            const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
            return days[date.getDay()];
        }
        
        function isWeekend(dateString) {
            const [day, month, year] = dateString.split('/').map(Number);
            const date = new Date(year, month - 1, day);
            const dayOfWeek = date.getDay();
            return dayOfWeek === 0 || dayOfWeek === 6;
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }
        
        function parseDateForInput(dateString) {
            const [day, month, year] = dateString.split('/').map(Number);
            return `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
        }
        
        function formatTime(startTime, endTime) {
            const start = startTime.replace(':', '.');
            const end = endTime.replace('.', ':');
            return `${start}–${end}`;
        }
        
        function parseTimeRange(timeString) {
            const [start, end] = timeString.split('–');
            const startTime = start.replace('.', ':');
            const endTime = end.replace('.', ':');
            return { startTime, endTime };
        }
        
        function saveData() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            localStorage.setItem('monthlySalary', monthlySalary);
            localStorage.setItem('endNormalTime', endNormalTime);
        }
        
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast`;
            toast.style.background = type === 'success' ? 'var(--accent)' : 
                                   type === 'error' ? 'var(--danger)' : 
                                   'var(--secondary)';
            
            const icon = type === 'success' ? 'check-circle' : 
                        type === 'error' ? 'exclamation-circle' : 
                        'info-circle';
            
            toast.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ==================== FUNGSI UNTUK HITUNG TOTAL ====================
        function hitungTotalSummary() {
            let totalHariKerja = attendanceData.length;
            let totalJamKerja = 0;
            let totalJamLembur = 0;
            let totalJamNormal = 0;
            let totalGaji = 0;
            
            const hourlyRate = monthlySalary / 173;
            
            attendanceData.forEach(item => {
                const details = item.calculationDetails || {};
                totalJamKerja += item.totalHours || 0;
                totalJamLembur += details.nilaiLembur || 0;
                totalJamNormal += details.jamNormal || 0;
                totalGaji += (item.totalHours || 0) * hourlyRate;
            });
            
            return {
                totalHariKerja,
                totalJamKerja: totalJamKerja.toFixed(1),
                totalJamLembur: totalJamLembur.toFixed(1),
                totalJamNormal: totalJamNormal.toFixed(1),
                totalGaji: totalGaji.toFixed(0)
            };
        }

        // ==================== FUNGSI EXPORT DENGAN SUMMARY ====================
        function exportDataWithSummary() {
            if (attendanceData.length === 0) {
                showToast('Tidak ada data untuk diexport', 'error');
                return;
            }
            
            // Hitung total summary
            const summary = hitungTotalSummary();
            const hourlyRate = monthlySalary / 173;
            const now = new Date();
            const exportDate = now.toLocaleDateString('id-ID');
            const exportTime = now.toLocaleTimeString('id-ID');
            
            let csvContent = "";
            
            // HEADER SUMMARY
            csvContent += "WORK SYNC - EXPORT DATA KEHADIRAN\n";
            csvContent += "========================================\n";
            csvContent += `Tanggal Export: ${exportDate} ${exportTime}\n`;
            csvContent += `Nama: ${document.getElementById('user-name').textContent}\n`;
            csvContent += `Posisi: ${document.getElementById('user-position').textContent}\n`;
            csvContent += `Gaji Bulanan: ${formatRupiah(monthlySalary)}\n`;
            csvContent += `Upah per Jam: ${formatRupiah(hourlyRate)}\n\n`;
            
            // SUMMARY DATA
            csvContent += "RINGKASAN TOTAL\n";
            csvContent += "----------------\n";
            csvContent += `Total Hari Kerja: ${summary.totalHariKerja} hari\n`;
            csvContent += `Total Jam Normal: ${summary.totalJamNormal} jam\n`;
            csvContent += `Total Jam Lembur: ${summary.totalJamLembur} jam (setara)\n`;
            csvContent += `Total Jam Kerja: ${summary.totalJamKerja} jam\n`;
            csvContent += `Total Gaji: ${formatRupiah(parseFloat(summary.totalGaji))}\n\n`;
            
            // DETAIL DATA
            csvContent += "DETAIL KEHADIRAN\n";
            csvContent += "========================================\n";
            csvContent += "No,Tanggal,Hari,Tipe Hari,Jam Masuk,Jam Pulang,Jam Kerja,Istirahat (jam),Jam Normal,Jam Lembur Real,Nilai Lembur (jam setara),Total Jam Dibayar,Catatan\n";
            
            attendanceData.forEach((item, index) => {
                const dayName = getDayName(item.date);
                const timeRange = parseTimeRange(item.hours);
                const details = item.calculationDetails || {};
                
                const tipeHariText = item.dayType === 'kerja' ? 'Hari Kerja' : 
                                   item.dayType === 'libur5' ? 'Libur (5H)' : 
                                   'Libur (6H) - Sabtu';
                
                csvContent += `${index + 1},"${item.date}","${dayName}","${tipeHariText}","${timeRange.startTime}","${timeRange.endTime}",`;
                csvContent += `${details.totalJamKerjaReal?.toFixed(1) || 0},${item.breakTime},`;
                csvContent += `${details.jamNormal || 0},${details.jamLemburReal || 0},`;
                csvContent += `${details.nilaiLembur?.toFixed(1) || 0},${item.totalHours?.toFixed(1) || 0},"${item.note || ''}"\n`;
            });
            
            // FOOTER
            csvContent += "\n\n";
            csvContent += "CATATAN PERHITUNGAN LEMBUR:\n";
            csvContent += "1. Hari Kerja: jam ke-1 = 1.5x, jam ke-2 = 2x, jam ke-3+ = 3x\n";
            csvContent += "2. Hari Libur (5H): jam ke-1-7 = 2x, jam ke-8 = 3x, jam ke-9+ = 4x\n";
            csvContent += "3. Hari Libur (6H - Sabtu): jam ke-1-5 = 2x, jam ke-6-7 = 3x, jam ke-8+ = 4x\n";
            csvContent += "\n";
            csvContent += "© 2025 WorkSync - Your Workforce, Perfectly Synchronized";
            
            // Buat blob dan download
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `worksync-report-${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            // Tampilkan summary dalam alert
            const summaryMessage = `
📊 RINGKASAN EXPORT DATA:

🗓️ Total Hari Kerja: ${summary.totalHariKerja} hari
⏰ Total Jam Normal: ${summary.totalJamNormal} jam
🔥 Total Jam Lembur: ${summary.totalJamLembur} jam (setara)
⏱️ Total Jam Kerja: ${summary.totalJamKerja} jam
💰 Total Gaji: ${formatRupiah(parseFloat(summary.totalGaji))}

✅ Data berhasil diexport ke file CSV!
            `;
            
            showToast('Data berhasil diexport dengan ringkasan lengkap!', 'success');
            
            // Tampilkan modal summary
            showExportSummary(summary);
        }

        // ==================== MODAL SUMMARY EXPORT ====================
        function showExportSummary(summary) {
            const modalHTML = `
                <div class="modal" id="export-summary-modal">
                    <div class="modal-content" style="max-width: 600px;">
                        <div class="modal-header">
                            <h3 style="color: white; margin: 0;">
                                <i class="fas fa-file-export mr-2"></i>
                                Ringkasan Export Data
                            </h3>
                            <button class="close-modal" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer;">
                                &times;
                            </button>
                        </div>
                        <div class="modal-body">
                            <div style="text-align: center; margin-bottom: 24px;">
                                <div style="width: 80px; height: 80px; background: rgba(0, 200, 83, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                    <i class="fas fa-check-circle" style="font-size: 32px; color: var(--accent);"></i>
                                </div>
                                <h3>Data Berhasil Diexport!</h3>
                                <p class="text-muted">File CSV telah didownload dengan ringkasan lengkap</p>
                            </div>
                            
                            <div class="summary-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                                <div class="summary-item" style="background: var(--gray-50); padding: 16px; border-radius: var(--radius-md); text-align: center;">
                                    <div class="summary-value" style="font-size: 24px; font-weight: 700; color: var(--primary);">
                                        ${summary.totalHariKerja}
                                    </div>
                                    <div class="summary-label" style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">
                                        <i class="fas fa-calendar-alt mr-1"></i> Hari Kerja
                                    </div>
                                </div>
                                <div class="summary-item" style="background: var(--gray-50); padding: 16px; border-radius: var(--radius-md); text-align: center;">
                                    <div class="summary-value" style="font-size: 24px; font-weight: 700; color: var(--accent);">
                                        ${summary.totalJamNormal}
                                    </div>
                                    <div class="summary-label" style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">
                                        <i class="fas fa-clock mr-1"></i> Jam Normal
                                    </div>
                                </div>
                                <div class="summary-item" style="background: var(--gray-50); padding: 16px; border-radius: var(--radius-md); text-align: center;">
                                    <div class="summary-value" style="font-size: 24px; font-weight: 700; color: var(--warning);">
                                        ${summary.totalJamLembur}
                                    </div>
                                    <div class="summary-label" style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">
                                        <i class="fas fa-fire mr-1"></i> Jam Lembur
                                    </div>
                                </div>
                                <div class="summary-item" style="background: var(--gray-50); padding: 16px; border-radius: var(--radius-md); text-align: center;">
                                    <div class="summary-value" style="font-size: 24px; font-weight: 700; color: var(--secondary);">
                                        ${summary.totalJamKerja}
                                    </div>
                                    <div class="summary-label" style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">
                                        <i class="fas fa-business-time mr-1"></i> Total Jam
                                    </div>
                                </div>
                            </div>
                            
                            <div class="total-salary" style="background: var(--gradient-primary); color: white; padding: 20px; border-radius: var(--radius-md); text-align: center;">
                                <div style="font-size: 12px; opacity: 0.9; margin-bottom: 8px;">
                                    TOTAL ESTIMASI GAJI
                                </div>
                                <div style="font-size: 32px; font-weight: 700;">
                                    ${formatRupiah(parseFloat(summary.totalGaji))}
                                </div>
                            </div>
                            
                            <div class="text-xs text-muted mt-4" style="text-align: center;">
                                <i class="fas fa-info-circle mr-1"></i>
                                File CSV berisi detail lengkap dan ringkasan ini
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary close-export-summary">
                                <i class="fas fa-check mr-2"></i>Mengerti
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Tambahkan modal ke body
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            const modal = document.getElementById('export-summary-modal');
            modal.style.display = 'flex';
            
            // Event listeners untuk modal
            modal.querySelector('.close-modal').addEventListener('click', () => {
                modal.remove();
            });
            
            modal.querySelector('.close-export-summary').addEventListener('click', () => {
                modal.remove();
            });
            
            // Close modal on ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal) {
                    modal.remove();
                }
            });
        }

        // ==================== PROFILE MANAGEMENT ====================
        function setupProfileEdit() {
            const userProfile = document.getElementById('user-profile');
            const userName = document.getElementById('user-name');
            const userPosition = document.getElementById('user-position');
            const userAvatar = document.getElementById('user-avatar');
            
            // Load saved profile
            const savedName = localStorage.getItem('hrUserName');
            const savedPosition = localStorage.getItem('hrUserPosition');
            
            if (savedName) {
                userName.textContent = savedName;
                updateAvatar(savedName);
            }
            
            if (savedPosition) {
                userPosition.textContent = savedPosition;
            }
            
            // Click to edit profile
            userProfile.addEventListener('click', function() {
                const currentName = userName.textContent;
                const currentPosition = userPosition.textContent;
                
                // Edit name
                const newName = prompt('Masukkan nama Anda:', currentName);
                if (newName && newName.trim() !== '') {
                    userName.textContent = newName;
                    updateAvatar(newName);
                    localStorage.setItem('hrUserName', newName);
                    showToast('Nama berhasil diupdate!', 'success');
                }
                
                // Edit position
                const newPosition = prompt('Masukkan posisi/jabatan:', currentPosition);
                if (newPosition && newPosition.trim() !== '') {
                    userPosition.textContent = newPosition;
                    localStorage.setItem('hrUserPosition', newPosition);
                    showToast('Posisi berhasil diupdate!', 'success');
                }
            });
            
            // Update avatar initials
            function updateAvatar(fullName) {
                const initials = fullName
                    .split(' ')
                    .map(word => word[0])
                    .join('')
                    .toUpperCase()
                    .substring(0, 2);
                
                userAvatar.textContent = initials;
            }
        }

        // ==================== TABLE MANAGEMENT ====================
        function renderTable() {
            const tbody = document.getElementById('attendance-data');
            const emptyState = document.getElementById('empty-state');
            const recordCount = document.getElementById('record-count');
            
            recordCount.textContent = `Total ${attendanceData.length} records`;
            
            if (attendanceData.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                document.getElementById('attendance-table').style.display = 'none';
            } else {
                emptyState.style.display = 'none';
                document.getElementById('attendance-table').style.display = 'table';
                
                tbody.innerHTML = attendanceData.map((item, index) => {
                    const dayName = getDayName(item.date);
                    const isWeekendDay = isWeekend(item.date);
                    const hasNote = item.note && item.note.trim() !== '';
                    
                    // Tentukan badge type berdasarkan tipe hari
                    let dayTypeBadge = '';
                    let dayTypeText = '';
                    
                    switch(item.dayType) {
                        case 'kerja':
                            dayTypeBadge = 'badge-info';
                            dayTypeText = 'Kerja';
                            break;
                        case 'libur5':
                            dayTypeBadge = 'badge-warning';
                            dayTypeText = 'Libur 5H';
                            break;
                        case 'libur6':
                            dayTypeBadge = 'badge-warning';
                            dayTypeText = 'Sabtu';
                            break;
                        default:
                            dayTypeBadge = 'badge-info';
                            dayTypeText = 'Kerja';
                    }
                    
                    return `
                    <tr id="row-${index}">
                        <td>
                            <div><strong>${item.date}</strong></div>
                            <div class="day-badge ${isWeekendDay ? 'day-weekend' : 'day-weekday'}">
                                <i class="fas ${isWeekendDay ? 'fa-umbrella-beach' : 'fa-briefcase'} mr-1"></i>
                                ${dayName}
                            </div>
                            <div class="badge ${dayTypeBadge} mt-1" style="font-size: 10px;">
                                ${dayTypeText}
                            </div>
                        </td>
                        <td>${item.hours}</td>
                        <td>${item.breakTime === 0 ? '-' : item.breakTime + ' jam'}</td>
                        <td>
                            ${item.overtime > 0 ? 
                                `<div class="badge badge-warning">
                                    ${item.overtime.toFixed(1)} jam
                                    <small class="ml-1">(${item.calculationDetails?.nilaiLembur || 0} setara)</small>
                                </div>` : 
                                '-'
                            }
                        </td>
                        <td>
                            <div class="badge ${item.totalHours >= 8 ? 'badge-success' : 'badge-info'}">
                                ${item.totalHours.toFixed(1)} jam
                            </div>
                        </td>
                        <td class="notes-cell" id="note-cell-${index}" onclick="toggleNote(${index})">
                            ${hasNote ? 
                                `<span class="text-sm">${item.note}</span>` : 
                                `<span class="text-muted text-sm">-</span>`
                            }
                        </td>
                        <td>
                            <div class="status-indicator">
                                <div class="status-dot" style="background: ${
                                    item.dayType === 'libur5' || item.dayType === 'libur6' ? 'var(--warning)' :
                                    item.totalHours >= 8 ? 'var(--accent)' : 'var(--info)'
                                }"></div>
                                <span class="text-xs">${
                                    item.dayType === 'libur5' ? 'Libur' :
                                    item.dayType === 'libur6' ? 'Sabtu' :
                                    item.totalHours >= 8 ? 'Complete' : 'Pending'
                                }</span>
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-outline btn-sm edit-btn" data-index="${index}" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline btn-sm delete-btn" data-index="${index}" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                                <button class="btn btn-outline btn-sm info-btn" data-index="${index}" title="Detail Perhitungan">
                                    <i class="fas fa-calculator"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    `;
                }).join('');
                
                // Add event listeners
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const index = parseInt(this.getAttribute('data-index'));
                        editAttendance(index);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const index = parseInt(this.getAttribute('data-index'));
                        deleteAttendance(index);
                    });
                });
                
                document.querySelectorAll('.info-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const index = parseInt(this.getAttribute('data-index'));
                        showCalculationDetails(index);
                    });
                });
            }
            
            updateCalculations();
            updateStats();
        }

        // Global function for note toggle
        window.toggleNote = function(index) {
            const noteCell = document.getElementById(`note-cell-${index}`);
            noteCell.classList.toggle('expanded');
        };

        // ==================== FUNGSI DETAIL PERHITUNGAN ====================
        function showCalculationDetails(index) {
            const data = attendanceData[index];
            const details = data.calculationDetails || {};
            
            const modalHTML = `
                <div class="modal" id="calculation-modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 style="color: white; margin: 0;">
                                <i class="fas fa-calculator mr-2"></i>
                                Detail Perhitungan
                            </h3>
                            <button class="close-modal" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer;">
                                &times;
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="calculation-details">
                                <div class="detail-item">
                                    <span class="detail-label">Tanggal:</span>
                                    <span class="detail-value">${data.date}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Jam Kerja:</span>
                                    <span class="detail-value">${data.hours}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Tipe Hari:</span>
                                    <span class="detail-value">${
                                        data.dayType === 'kerja' ? 'Hari Kerja (Senin-Jumat)' :
                                        data.dayType === 'libur5' ? 'Hari Libur (5 Hari Kerja)' :
                                        'Hari Libur (6 Hari Kerja) - Sabtu'
                                    }</span>
                                </div>
                                <div class="separator"></div>
                                <div class="detail-item">
                                    <span class="detail-label">Total Jam Real:</span>
                                    <span class="detail-value">${details.totalJamKerjaReal?.toFixed(1) || 0} jam</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Istirahat:</span>
                                    <span class="detail-value">${data.breakTime} jam</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Jam Normal:</span>
                                    <span class="detail-value">${details.jamNormal || 0} jam</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Jam Lembur Real:</span>
                                    <span class="detail-value">${details.jamLemburReal || 0} jam</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Nilai Lembur:</span>
                                    <span class="detail-value">${details.nilaiLembur?.toFixed(1) || 0} jam (setara)</span>
                                </div>
                                <div class="separator"></div>
                                <div class="detail-item total">
                                    <span class="detail-label">Total Dibayar:</span>
                                    <span class="detail-value">${details.totalDibayarDalamJam?.toFixed(1) || 0} jam</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary close-modal-btn">Tutup</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Tambahkan modal ke body
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            const modal = document.getElementById('calculation-modal');
            modal.style.display = 'flex';
            
            // Event listeners untuk modal
            modal.querySelector('.close-modal').addEventListener('click', () => {
                modal.remove();
            });
            
            modal.querySelector('.close-modal-btn').addEventListener('click', () => {
                modal.remove();
            });
            
            // Close modal on ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal) {
                    modal.remove();
                }
            });
        }

        // ==================== CALCULATIONS ====================
        function updateCalculations() {
            let totalDays = attendanceData.length;
            let totalHours = 0;
            let overtimeHours = 0;
            let normalHours = 0;
            
            attendanceData.forEach(item => {
                totalHours += item.totalHours;
                overtimeHours += (item.calculationDetails?.nilaiLembur || 0);
                normalHours += (item.calculationDetails?.jamNormal || 0);
            });
            
            const hourlyRate = monthlySalary / 173;
            const estimatedSalary = totalHours * hourlyRate;
            
            document.getElementById('calc-total-days').textContent = totalDays;
            document.getElementById('calc-total-hours').textContent = totalHours.toFixed(1);
            document.getElementById('calc-overtime-hours').textContent = overtimeHours.toFixed(1);
            document.getElementById('calc-hourly-rate').textContent = formatRupiah(hourlyRate);
            document.getElementById('calc-total-salary').textContent = formatRupiah(estimatedSalary);
        }

        function updateStats() {
            let totalHours = 0;
            let totalDays = attendanceData.length;
            
            attendanceData.forEach(item => {
                totalHours += item.totalHours;
            });
            
            const hourlyRate = monthlySalary / 173;
            const estimatedSalary = totalHours * hourlyRate;
            
            document.getElementById('stat-total-hours').textContent = totalHours.toFixed(1) + ' jam';
            document.getElementById('stat-total-days').textContent = totalDays + ' hari';
            document.getElementById('stat-estimated-salary').textContent = formatRupiah(estimatedSalary);
        }

        // ==================== ATTENDANCE MANAGEMENT ====================
        function addAttendance(e) {
            e.preventDefault();
            
            if (isEditMode) {
                showToast('Selesaikan edit terlebih dahulu', 'error');
                return;
            }
            
            const date = document.getElementById('date').value;
            const startTime = document.getElementById('start-time').value;
            const endTime = document.getElementById('end-time').value;
            const breakTime = parseFloat(document.getElementById('break-time').value);
            const dayType = document.getElementById('day-type').value;
            const inputOvertime = parseFloat(document.getElementById('overtime').value) || 0;
            const note = document.getElementById('note').value;
            
            if (!date || !startTime || !endTime) {
                showToast('Harap isi semua field yang diperlukan', 'error');
                return;
            }
            
            // Hitung menggunakan fungsi baru
            const perhitungan = hitungKerja({
                jamMasuk: startTime,
                jamPulang: endTime,
                tipeHari: dayType,
                istirahat: breakTime
            });
            
            // Format data untuk disimpan
            const formattedDate = formatDate(date);
            const formattedHours = formatTime(startTime, endTime);
            
            const attendance = {
                date: formattedDate,
                hours: formattedHours,
                breakTime: breakTime,
                overtime: perhitungan.jamLemburReal,
                totalHours: perhitungan.totalDibayarDalamJam,
                dayType: dayType,
                note: note,
                // Simpan detail perhitungan untuk tampilan
                calculationDetails: perhitungan
            };
            
            attendanceData.push(attendance);
            saveData();
            renderTable();
            resetForm();
            
            // Tampilkan detail perhitungan dalam toast
            showToast(
                `Data berhasil disimpan!<br>
                Jam Normal: ${perhitungan.jamNormal} jam<br>
                Lembur: ${perhitungan.jamLemburReal} jam (${perhitungan.nilaiLembur} jam setara)<br>
                Total: ${perhitungan.totalDibayarDalamJam.toFixed(1)} jam`,
                'success'
            );
        }
        
        function editAttendance(index) {
            const data = attendanceData[index];
            const dateInput = parseDateForInput(data.date);
            const timeRange = parseTimeRange(data.hours);
            
            document.getElementById('date').value = dateInput;
            document.getElementById('start-time').value = timeRange.startTime;
            document.getElementById('end-time').value = timeRange.endTime;
            document.getElementById('break-time').value = data.breakTime;
            document.getElementById('day-type').value = data.dayType || 'kerja';
            document.getElementById('overtime').value = data.overtime || '';
            document.getElementById('note').value = data.note || '';
            document.getElementById('edit-index').value = index;
            
            activateEditMode(index);
        }
        
        function updateAttendance() {
            const index = parseInt(document.getElementById('edit-index').value);
            
            const date = document.getElementById('date').value;
            const startTime = document.getElementById('start-time').value;
            const endTime = document.getElementById('end-time').value;
            const breakTime = parseFloat(document.getElementById('break-time').value);
            const dayType = document.getElementById('day-type').value;
            const inputOvertime = parseFloat(document.getElementById('overtime').value) || 0;
            const note = document.getElementById('note').value;
            
            // Hitung menggunakan fungsi baru
            const perhitungan = hitungKerja({
                jamMasuk: startTime,
                jamPulang: endTime,
                tipeHari: dayType,
                istirahat: breakTime
            });
            
            const formattedDate = formatDate(date);
            const formattedHours = formatTime(startTime, endTime);
            
            attendanceData[index] = {
                date: formattedDate,
                hours: formattedHours,
                breakTime: breakTime,
                overtime: perhitungan.jamLemburReal,
                totalHours: perhitungan.totalDibayarDalamJam,
                dayType: dayType,
                note: note,
                calculationDetails: perhitungan
            };
            
            saveData();
            renderTable();
            deactivateEditMode();
            
            showToast('Data berhasil diupdate dengan perhitungan baru!', 'success');
        }
        
        function deleteAttendance(index) {
            if (confirm('Hapus data ini?')) {
                attendanceData.splice(index, 1);
                saveData();
                renderTable();
                showToast('Data berhasil dihapus', 'success');
            }
        }
        
        function deleteAllData() {
            attendanceData = [];
            saveData();
            renderTable();
            document.getElementById('delete-modal').style.display = 'none';
            showToast('Semua data berhasil dihapus', 'success');
        }
        
        // ==================== EDIT MODE MANAGEMENT ====================
        function activateEditMode(index) {
            isEditMode = true;
            currentEditIndex = index;
            document.getElementById('edit-notice').style.display = 'block';
            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('update-btn').style.display = 'flex';
            document.getElementById('cancel-edit').style.display = 'flex';
            document.getElementById('reset-form').style.display = 'none';
        }
        
        function deactivateEditMode() {
            isEditMode = false;
            currentEditIndex = -1;
            document.getElementById('edit-notice').style.display = 'none';
            document.getElementById('submit-btn').style.display = 'flex';
            document.getElementById('update-btn').style.display = 'none';
            document.getElementById('cancel-edit').style.display = 'none';
            document.getElementById('reset-form').style.display = 'flex';
            resetForm();
        }
        
        function resetForm() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            document.getElementById('start-time').value = '08:00';
            document.getElementById('end-time').value = '17:00';
            document.getElementById('break-time').value = '1';
            document.getElementById('day-type').value = 'kerja';
            document.getElementById('overtime').value = '';
            document.getElementById('note').value = '';
        }

        // ==================== INITIALIZATION ====================
        function init() {
            // Setup profile edit feature
            setupProfileEdit();
            
            // Set default date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            
            // Initial render
            renderTable();
            
            // Update time display
            function updateDateTime() {
                const now = new Date();
                const dateOptions = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
                const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
                
                document.getElementById('current-date').textContent = 
                    now.toLocaleDateString('id-ID', dateOptions);
                document.getElementById('current-time').textContent = 
                    now.toLocaleTimeString('id-ID', timeOptions);
            }
            
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Form submission
            document.getElementById('attendance-form').addEventListener('submit', addAttendance);
            document.getElementById('update-btn').addEventListener('click', updateAttendance);
            document.getElementById('cancel-edit').addEventListener('click', deactivateEditMode);
            document.getElementById('reset-form').addEventListener('click', resetForm);
            
            // Add first data
            document.getElementById('add-first-data').addEventListener('click', function() {
                document.getElementById('date').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Salary configuration
            document.getElementById('save-salary').addEventListener('click', function() {
                const newSalary = parseInt(document.getElementById('monthly-salary').value);
                if (newSalary >= 1000000) {
                    monthlySalary = newSalary;
                    saveData();
                    updateCalculations();
                    updateStats();
                    showToast('Gaji berhasil diupdate', 'success');
                }
            });
            
            // Data management
            document.getElementById('delete-all-data').addEventListener('click', function() {
                if (attendanceData.length === 0) {
                    showToast('Tidak ada data untuk dihapus', 'info');
                    return;
                }
                document.getElementById('delete-count').textContent = attendanceData.length;
                document.getElementById('delete-modal').style.display = 'flex';
            });
            
            // Export data dengan summary
            document.getElementById('export-data').addEventListener('click', exportDataWithSummary);
            
            // Backup data
            document.getElementById('backup-data').addEventListener('click', function() {
                const backupData = {
                    attendanceData: attendanceData,
                    monthlySalary: monthlySalary,
                    exportDate: new Date().toISOString(),
                    user: {
                        name: document.getElementById('user-name').textContent,
                        position: document.getElementById('user-position').textContent
                    }
                };
                
                const dataStr = JSON.stringify(backupData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `worksync-backup-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showToast('Backup data berhasil dibuat!', 'success');
            });
            
            // Modal events
            document.getElementById('confirm-delete').addEventListener('input', function() {
                document.getElementById('confirm-delete-btn').disabled = 
                    this.value.toUpperCase() !== 'HAPUS';
            });
            
            document.getElementById('confirm-delete-btn').addEventListener('click', deleteAllData);
            
            document.getElementById('cancel-delete').addEventListener('click', function() {
                document.getElementById('delete-modal').style.display = 'none';
            });
            
            document.querySelector('#delete-modal .close-modal').addEventListener('click', function() {
                document.getElementById('delete-modal').style.display = 'none';
            });
            
            // Print data
            document.getElementById('print-data').addEventListener('click', function() {
                window.print();
            });
            
            // Close modal on ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.getElementById('delete-modal').style.display = 'none';
                    const calcModal = document.getElementById('calculation-modal');
                    if (calcModal) calcModal.remove();
                    const exportModal = document.getElementById('export-summary-modal');
                    if (exportModal) exportModal.remove();
                    if (isEditMode) deactivateEditMode();
                }
            });
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
